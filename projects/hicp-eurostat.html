<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Prism (syntax highlighting) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css">
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js"
          data-autoloader-path="https://cdn.jsdelivr.net/npm/prismjs@1/components/"></script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Eurostat HICP (EU-27) — Power BI | Saber Sojudi Abdee Fard</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://unpkg.com/feather-icons"></script>

  <!-- SEO / Social -->
  <meta name="description" content="Power BI model for Eurostat HICP (EU-27) with star schema, core DAX measures (Index, MoM, YoY), and refreshable Eurostat API ingestion in Power Query. Python app version included."/>
  <meta property="og:title" content="Eurostat HICP (EU-27) — Power BI" />
  <meta property="og:description" content="Star schema, core DAX measures, Eurostat API ingestion, and Python app version." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="../assets/hicp-cover.jpg" />
  <meta property="og:url" content="https://YOUR_DOMAIN/projects/hicp-eurostat.html" />
  <link rel="icon" href="../assets/favicon.png"/>

  <style>
    /* Keep anchors from hiding under fixed header */
    html { scroll-padding-top: 96px; }
    section[id] { scroll-margin-top: 96px; }

    /* Header links identical to main page (gray text + blue underline) */
    .nav-link{
      position: relative; font-size: 1rem; line-height: 1.5rem; color: #374151;
    }
    .nav-link::after{
      content:''; position:absolute; left:0; right:0; bottom:-4px; height:2px; width:0;
      background-color:#3b82f6; transition:width .3s ease;
    }
    .nav-link:hover::after, .nav-link.active::after{ width:100%; }

    /* Code theme (dark, readable) */
    .code-wrap { position: relative; }
    pre.code, pre[class*="language-"]{
      background:#0b1021; color:#e6edf3; padding:16px 18px; border-radius:12px;
      overflow:auto; line-height:1.5; border:1px solid rgba(148,163,184,.25);
      box-shadow: 0 6px 18px rgba(2,8,23,.15);
    }
    .token.comment,.token.prolog,.token.doctype { color:#94a3b8; }
    .token.keyword { color:#7aa2f7; }
    .token.function { color:#c099ff; }
    .token.number,.token.boolean { color:#f7768e; }
    .token.string { color:#9ece6a; }
    .token.operator { color:#89ddff; }

    /* Collapsible long code blocks */
    .clamp { max-height: 20rem; }
    .code-overlay {
      content: ""; position:absolute; left:0; right:0; bottom:0; height:5rem;
      background: linear-gradient(to bottom, rgba(11,16,33,0) 0%, #0b1021 65%);
      border-bottom-left-radius:12px; border-bottom-right-radius:12px; pointer-events:none;
    }
    .expand-btn {
      position:absolute; right:14px; bottom:10px; z-index:2; font-size:.875rem; padding:.35rem .6rem;
      border-radius:8px; background:#111827; color:#fff; border:1px solid rgba(148,163,184,.35);
    }
    .expand-btn:hover { background:#0f172a; }

    /* Tiles (used elsewhere if needed) */
    .media-tile { position:relative; overflow:hidden; border-radius:16px;
                  background:#fff; border:1px solid rgba(100,116,139,.18); }
    .media-tile img { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; }
  </style>
</head>
<body class="bg-gray-50">

  <!-- Header (with Back button to main page) -->
  <nav class="fixed w-full bg-white bg-opacity-90 backdrop-blur-sm z-50 shadow-sm">
    <div class="container mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <!-- Brand (also links home) -->
        <a href="../index.html" class="text-xl font-bold text-blue-600">Saber Sojudi</a>

        <!-- Desktop nav -->
        <div class="hidden md:flex space-x-8">
          <a href="#overview"   class="nav-link">Overview</a>
          <a href="#model"      class="nav-link">Model</a>
          <a href="#measures"   class="nav-link">Core DAX</a>
          <a href="#powerquery" class="nav-link">Power Query</a>
          <a href="#pyapp"      class="nav-link">Python App</a>
        </div>

        <!-- Right cluster: Back button + mobile menu toggle -->
        <div class="flex items-center gap-3">
          <!-- Back to main page (visible on all sizes; label hidden on xs for space) -->
          <a href="../index.html"
             class="inline-flex items-center px-3 py-1.5 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-100"
             title="Back to main page">
            <i data-feather="arrow-left" class="w-4 h-4 mr-2"></i>
            <span class="hidden sm:inline">Back</span>
          </a>

          <!-- Mobile menu button -->
          <button id="menuBtn" class="md:hidden text-gray-700" aria-label="Open Menu">
            <i data-feather="menu"></i>
          </button>
        </div>
      </div>

      <!-- Mobile drawer -->
      <div id="mobileMenu" class="md:hidden mt-3 hidden">
        <div class="flex flex-col space-y-3">
          <a href="#overview"   class="nav-link">Overview</a>
          <a href="#model"      class="nav-link">Model</a>
          <a href="#measures"   class="nav-link">Core DAX</a>
          <a href="#powerquery" class="nav-link">Power Query</a>
          <a href="#pyapp"      class="nav-link">Python App</a>
          <a href="../index.html#projects" class="nav-link">← Back to Home</a>
        </div>
      </div>
    </div>
  </nav>

  <main class="relative z-10">
    <!-- OVERVIEW + SLIDER -->
    <section id="overview" class="pt-28 pb-12">
      <div class="max-w-6xl mx-auto px-6">
        <div class="grid md:grid-cols-2 gap-8 items-start">
          <!-- LEFT: Overview text -->
          <div data-aos="fade-right">
            <h1 class="text-3xl md:text-4xl font-extrabold text-slate-900">
              Eurostat HICP (EU-27) — Power BI
            </h1>
            <p class="mt-3 text-slate-600 max-w-2xl">
              EU-themed Power BI model for the Harmonised Index of Consumer Prices (HICP). Includes a clean
              <strong>star schema</strong>, <strong>core DAX measures</strong> (Index, Monthly/Annual rates),
              and refreshable <strong>Eurostat API</strong> ingestion in Power Query (M). A lightweight
              <strong>Python app version</strong> is available too.
            </p>

            <div class="mt-5 flex flex-wrap gap-2">
              <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white border border-slate-200 text-slate-700 shadow-sm">
                <i data-feather="bar-chart-2" class="w-4 h-4 text-blue-600"></i> Power BI
              </span>
              <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white border border-slate-200 text-slate-700 shadow-sm">
                <i data-feather="sliders" class="w-4 h-4 text-blue-600"></i> DAX
              </span>
              <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white border border-slate-200 text-slate-700 shadow-sm">
                <i data-feather="shuffle" class="w-4 h-4 text-blue-600"></i> Power Query (M)
              </span>
              <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white border border-slate-200 text-slate-700 shadow-sm">
                <i data-feather="cpu" class="w-4 h-4 text-blue-600"></i> Python App
              </span>
            </div>

            <div class="mt-6 flex flex-wrap gap-3">
              <a href="https://github.com/sabers13/Eurostat-HICP/tree/main" target="_blank" rel="noopener"
                 class="inline-flex items-center px-5 py-2.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800">
                <i data-feather="github" class="w-5 h-5 mr-2"></i> View on GitHub
              </a>
              <a href="https://sabers13.github.io#contact"
                 class="inline-flex items-center px-5 py-2.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
                <i data-feather="briefcase" class="w-5 h-5 mr-2"></i> Hire Me
              </a>
            </div>
          </div>

          <!-- RIGHT: Slider (white bg, contain, autoplay, dots, progress, lightbox) -->
          <div class="relative group" data-slider>
            <div class="relative overflow-hidden rounded-2xl shadow ring-1 ring-slate-200 bg-white">
              <div class="h-[22rem] md:h-[26rem] lg:h-[28rem] bg-white">
                <div class="flex h-full transition-transform duration-500 ease-out will-change-transform" data-track>
                  <!-- Slides -->
                  <div class="w-full shrink-0 flex items-center justify-center">
                    <img src="https://github.com/sabers13/Eurostat-HICP/blob/main/sample1.png?raw=true"
                         data-zoom="https://github.com/sabers13/Eurostat-HICP/blob/main/sample1.png?raw=true"
                         alt="HICP — Overview"
                         class="max-w-full max-h-full object-contain cursor-zoom-in"
                         loading="lazy">
                  </div>
                  <div class="w-full shrink-0 flex items-center justify-center">
                    <img src="https://github.com/sabers13/Eurostat-HICP/blob/main/sample2.png?raw=true"
                         data-zoom="https://github.com/sabers13/Eurostat-HICP/blob/main/sample2.png?raw=true"
                         alt="HICP — Trends"
                         class="max-w-full max-h-full object-contain cursor-zoom-in"
                         loading="lazy">
                  </div>
                  <div class="w-full shrink-0 flex items-center justify-center">
                    <img src="https://github.com/sabers13/Eurostat-HICP/blob/main/sample3.png?raw=true"
                         data-zoom="https://github.com/sabers13/Eurostat-HICP/blob/main/sample3.png?raw=true"
                         alt="HICP — Categories"
                         class="max-w-full max-h-full object-contain cursor-zoom-in"
                         loading="lazy">
                  </div>
                  <div class="w-full shrink-0 flex items-center justify-center">
                    <img src="https://github.com/sabers13/Eurostat-HICP/blob/main/sample4.png?raw=true"
                         data-zoom="https://github.com/sabers13/Eurostat-HICP/blob/main/sample4.png?raw=true"
                         alt="HICP — Mobile"
                         class="max-w-full max-h-full object-contain cursor-zoom-in"
                         loading="lazy">
                  </div>
                </div>
              </div>

              <!-- Gradient edges -->
              <div class="pointer-events-none absolute inset-y-0 left-0 w-16 bg-gradient-to-r from-white via-white/90 to-transparent"></div>
              <div class="pointer-events-none absolute inset-y-0 right-0 w-16 bg-gradient-to-l from-white via-white/90 to-transparent"></div>

              <!-- Arrows -->
              <button class="absolute left-2 top-1/2 -translate-y-1/2 bg-white hover:bg-slate-50 rounded-full p-2 shadow border" data-prev aria-label="Previous">
                <i data-feather="chevron-left" class="w-5 h-5"></i>
              </button>
              <button class="absolute right-2 top-1/2 -translate-y-1/2 bg-white hover:bg-slate-50 rounded-full p-2 shadow border" data-next aria-label="Next">
                <i data-feather="chevron-right" class="w-5 h-5"></i>
              </button>

              <!-- Progress -->
              <div class="absolute bottom-0 left-0 right-0 h-1 bg-slate-200/70">
                <div class="h-full bg-blue-600/90 transition-[width] duration-100" data-progress style="width:0%"></div>
              </div>
            </div>

            <!-- Dots + counter -->
            <div class="mt-3 flex items-center justify-center gap-3">
              <div class="flex gap-2" data-dots>
                <button class="w-2.5 h-2.5 rounded-full bg-slate-300 shadow" data-dot="0"></button>
                <button class="w-2.5 h-2.5 rounded-full bg-slate-300 shadow" data-dot="1"></button>
                <button class="w-2.5 h-2.5 rounded-full bg-slate-300 shadow" data-dot="2"></button>
                <button class="w-2.5 h-2.5 rounded-full bg-slate-300 shadow" data-dot="3"></button>
              </div>
              <span class="text-xs text-slate-500 select-none" data-counter>1 / 4</span>
            </div>

            <p class="text-slate-500 text-xs mt-2 text-center">Click any image to enlarge.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- DATA MODEL (equal-height columns) -->
    <section id="model" class="py-12">
      <div class="max-w-6xl mx-auto px-6">
        <h2 class="text-2xl font-bold text-slate-900 mb-4">Data Model</h2>

        <div class="grid md:grid-cols-2 gap-8 items-stretch">
          <!-- Left card -->
          <div class="bg-white rounded-xl p-6 shadow border border-slate-200 h-full">
            <h3 class="font-semibold text-slate-800 mb-2">Tables</h3>
            <ul class="list-disc list-inside text-slate-700 space-y-1">
              <li><strong>FactHICP_Index</strong></li>
              <li><strong>FactHICP_Rates_YoY</strong></li>
              <li><strong>FactHICP_Rates_MoM</strong></li>
              <li><strong>FactHICP_Weights</strong></li>
              <li><strong>DimDate</strong></li>
              <li><strong>DimGeo</strong></li>
              <li><strong>DimCOICOP</strong></li>
            </ul>
            <p class="mt-3 text-slate-600 text-sm">
              Facts are filtered by DimDate, DimGeo, and DimCOICOP (single-direction). Separate facts keep rates
              lean and queryable without row-level recomputation.
            </p>
          </div>

          <!-- Right card (diagram fills height; image preserves aspect) -->
          <figure class="bg-white rounded-xl p-3 shadow border border-slate-200 h-full flex flex-col">
            <div class="flex-1 flex items-center justify-center">
              <img
                src="https://github.com/sabers13/Eurostat-HICP/blob/main/model%20view.png?raw=true"
                alt="Power BI Model View (HICP)"
                class="max-w-full max-h-full object-contain cursor-zoom-in bg-white rounded-lg">
            </div>
            <figcaption class="text-slate-500 text-xs mt-2 text-center">
              Model view: facts + dimensions (star schema).
            </figcaption>
          </figure>
        </div>
      </div>
    </section>

    <!-- CORE DAX -->
    <section id="measures" class="py-6">
      <div class="max-w-6xl mx-auto px-6">
        <h2 class="text-2xl font-bold text-slate-900 mb-4">Core DAX Measures</h2>
        <p class="text-slate-700 mb-3">
          Below are the core measures used throughout the report.
          <strong>More measures are available in the repository.</strong>
        </p>
<pre class="code"><code>Index =
AVERAGE ( FactHICP_Index[value] )

Annual inflation rate =
VAR Prev12 =
    CALCULATE (
        [Index],
        DATEADD ( DimDate[Date], -12, MONTH ),
        KEEPFILTERS ( VALUES ( DimGeo[geo] ) ),
        KEEPFILTERS ( VALUES ( DimCOICOP[coicop] ) )
    )
RETURN
    IF ( ISBLANK ( Prev12 ), BLANK (), DIVIDE ( [Index] - Prev12, Prev12 ) )

Monthly inflation rate =
VAR Curr = [Index]
VAR Prev = CALCULATE ( [Index], DATEADD ( DimDate[Date], -1, MONTH ) )
RETURN DIVIDE ( Curr - Prev, Prev )</code></pre>
      </div>
    </section>

    <!-- POWER QUERY -->
    <section id="powerquery" class="py-6">
      <div class="max-w-6xl mx-auto px-6">
        <h2 class="text-2xl font-bold text-slate-900 mb-4">Power Query (M) — Eurostat API</h2>

        <div class="code-wrap">
<pre class="code language-powerquery"><code>let
    // --- Parameters ---
    dataset     = "prc_hicp_midx",
    unitCode    = "I15",
    startMonth  = pStartMonth,
    endMonth    = pEndMonth,
    geosList    = pGeos,
    coicopsList = pCoicops,

    // --- Eurostat Statistics API URL ---
    Base   = "https://ec.europa.eu/eurostat/api/dissemination/statistics/1.0/data/",
    Parts  = List.Combine({
                {"lang=EN","freq=M","unit=" & unitCode,
                 "sinceTimePeriod=" & startMonth,"untilTimePeriod=" & endMonth},
                List.Transform(coicopsList, each "coicop=" & _),
                List.Transform(geosList,    each "geo=" & _)
            }),
    Url    = Base & dataset & "?" & Text.Combine(Parts, "&"),

    // --- Fetch + parse JSON-stat 2.0 ---
    Raw = Web.Contents(Url, [Timeout=#duration(0,0,90,0), Headers=[Accept="application/json"]]),
    J   = Json.Document(Raw),
    D   = if Record.HasFields(J, "dataset") then J[dataset] else J,

    // --- Dimensions (lower-cased) ---
    Ids  = List.Transform(D[id], each Text.Lower(Text.From(_))),
    DimR = Record.FromList(Record.FieldValues(D[dimension]),
                           List.Transform(Record.FieldNames(D[dimension]), Text.Lower)),

    GetCodes = (dimname as text) as list =>
        let d = Record.Field(DimR, dimname),
            cat = d[category],
            idx = try cat[index] otherwise null,
            codes =
                if idx <> null then
                    if Value.Is(cat[index], type list) then List.Transform(cat[index], each Text.From(_))
                    else if Value.Is(cat[index], type record)
                         then List.Transform(Table.Sort(Record.ToTable(cat[index]), {{"Value", Order.Ascending}})[Name], each Text.From(_))
                         else Record.FieldNames(cat[label])
                else if Record.HasFields(cat,"label") then Record.FieldNames(cat[label]) else {}
        in  codes,

    Codes = List.Transform(Ids, each GetCodes(_)),
    Sizes = List.Transform(Codes, each List.Count(_)),
    Mdim  = List.Count(Sizes),
    N     = if Mdim=0 then 0 else List.Product(Sizes),

    // --- Dense values vector (FIXED ReplaceRange call) ---
    ValRaw = D[value],
    Values =
        if Value.Is(ValRaw, type list) then ValRaw
        else if Value.Is(ValRaw, type record) then
            let names = Record.FieldNames(ValRaw),
                vals  = Record.FieldValues(ValRaw),
                pos   = List.Transform(names, each Number.FromText(_)),
                base  = List.Repeat({null}, N),
                zipped= List.Zip({pos, vals}),
                filled= List.Accumulate(zipped, base, (st, p) => List.ReplaceRange(st, p{0}, 1, {p{1}}))
            in  filled
        else List.Repeat({null}, N),

    // --- Build columns (last dimension varies fastest) ---
    Result =
        if N=0 then #table(Ids & {"value"}, {})
        else
            let
                idxs    = {0..N-1},
                radices = List.Transform({0..Mdim-1}, each if _=Mdim-1 then 1 else List.Product(List.Range(Sizes, _+1, Mdim-(_+1)))),
                DimCol  = (k as number) =>
                            let sizeK = Sizes{k}, radK = radices{k}, codeK = Codes{k}
                            in  List.Transform(idxs, (i)=> codeK{ Number.Mod(Number.IntegerDivide(i, radK), sizeK)}),
                Tbl     = Table.FromColumns(List.Transform({0..Mdim-1}, each DimCol(_)) & {Values}, Ids & {"value"})
            in  Tbl,

    // --- Clean & keep core fields ---
    Lower   = Table.TransformColumnNames(Result, Text.Lower),
    Norm    = if List.Contains(Table.ColumnNames(Lower), "time_period")
              then Table.RenameColumns(Lower, {{"time_period","time"}}) else Lower,
    WithUnit= if List.Contains(Table.ColumnNames(Norm), "unit")
              then Norm else Table.AddColumn(Norm, "unit", each unitCode, type text),
    Keep    = Table.SelectColumns(WithUnit, {"time","geo","coicop","unit","value"}, MissingField.Ignore),
    Typed   = Table.TransformColumnTypes(
                Keep,
                {{"time", type text},{"geo", type text},{"coicop", type text},{"unit", type text},{"value", type number}},
                "en-US"
              ),

    AddDate = Table.AddColumn(Typed, "Date", each Date.FromText([time] & "-01"), type date)
in
    AddDate</code></pre>
        </div>

        <p class="text-slate-600 text-sm mt-2">
          Parameters <code>pStartMonth</code>, <code>pEndMonth</code>, <code>pGeos</code>, <code>pCoicops</code> scope refresh.
        </p>
      </div>
    </section>

    <!-- PYTHON APP + DATA & VIZ -->
    <section id="pyapp" class="py-12">
      <div class="max-w-6xl mx-auto px-6">

        <div class="grid md:grid-cols-2 gap-8 items-stretch">
          <div data-aos="fade-right">
            <h2 class="text-2xl font-bold text-slate-900 mb-4">Python App (Interactive Explorer)</h2>
            <p class="text-slate-700">
              A lightweight, tabbed web app that lets you slice the Eurostat HICP data by
              <em>time window</em>, <em>geographies</em>, and <em>COICOP categories</em>, and then view
              index levels plus monthly/annual rates in charts and tables. Filters live in a compact panel;
              tabs switch between overview, trends, and comparisons. Data is pulled/reshaped in helpers and
              shared across tabs via a simple app state.
            </p>
          </div>

          <aside class="bg-white rounded-xl p-5 shadow border border-slate-200 h-full" data-aos="fade-left">
            <h3 class="font-semibold text-slate-800 mb-2">Code layout</h3>
            <ul class="list-disc list-inside text-slate-700 space-y-1">
              <li><a class="text-blue-600 hover:underline" target="_blank" rel="noopener"
                     href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/main.py">main.py</a> — app entrypoint / wiring</li>
              <li><a class="text-blue-600 hover:underline" target="_blank" rel="noopener"
                     href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/tabs.py">tabs.py</a> — page sections / tabs</li>
              <li><a class="text-blue-600 hover:underline" target="_blank" rel="noopener"
                     href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/filters.py">filters.py</a> — sidebar controls (date, geo, COICOP)</li>
              <li><a class="text-blue-600 hover:underline" target="_blank" rel="noopener"
                     href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/helpers.py">helpers.py</a> — data fetch/transform utilities</li>
            </ul>
            <p class="text-xs text-slate-500 mt-2">Full source and more notes are in the repository.</p>
          </aside>
        </div>

        <!-- App preview (click to enlarge) -->
        <figure class="mt-10 rounded-3xl overflow-hidden shadow-xl ring-1 ring-slate-200 bg-white" data-aos="fade-up">
          <img src="https://raw.githubusercontent.com/sabers13/Eurostat-HICP/refs/heads/main/app/sample.png"
               alt="HICP Python app preview" class="w-full h-auto object-cover cursor-zoom-in">
          <figcaption class="px-6 py-3 text-slate-500 text-sm">Preview of the HICP interactive app.</figcaption>
        </figure>

        <!-- Data & Viz highlights -->
        <div class="mt-12">
          <div class="flex items-center justify-between flex-wrap gap-3">
            <h3 class="text-xl font-bold text-slate-900">Data &amp; Viz Highlights</h3>
            <a href="https://github.com/sabers13/Eurostat-HICP/tree/main/app" target="_blank" rel="noopener"
               class="inline-flex items-center px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800">
              <i data-feather="github" class="w-5 h-5 mr-2"></i> Open <strong>app/</strong> on GitHub
            </a>
          </div>

          <div class="bg-white rounded-xl p-5 shadow border border-slate-200 mb-8">
            <div class="flex items-center justify-between mb-3">
              <p class="font-semibold text-slate-800 m-0">filters.py — user controls</p>
              <a class="text-blue-600 text-sm hover:underline" target="_blank" rel="noopener"
                 href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/filters.py">Open file</a>
            </div>
<pre class="language-python"><code># Countries/regions and COICOP categories (trimmed example)
GEOS = ["EU", "DE", "IT", "PL"]
COICOPS = ["CP00", "CP011", "CP012"]  # All-items + examples

# Default time window (Eurostat YYYY-MM)
DEFAULT_START = "2016-01"
DEFAULT_END   = "2025-01"</code></pre>
          </div>

          <div class="bg-white rounded-xl p-5 shadow border border-slate-200 mb-8">
            <div class="flex items-center justify-between mb-3">
              <p class="font-semibold text-slate-800 m-0">helpers.py — Eurostat fetch &amp; shaping</p>
              <a class="text-blue-600 text-sm hover:underline" target="_blank" rel="noopener"
                 href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/helpers.py">Open file</a>
            </div>
<pre class="language-python"><code>import requests, pandas as pd

BASE = "https://ec.europa.eu/eurostat/api/dissemination/statistics/1.0/data/prc_hicp_midx"

def build_url(start, end, geos, coicops, unit="I15"):
    params = [f"lang=EN", f"freq=M", f"unit={unit}",
              f"sinceTimePeriod={start}", f"untilTimePeriod={end}"]
    params += [*(f"geo={g}" for g in geos), *(f"coicop={c}" for c in coicops)]
    return f"{BASE}?" + "&".join(params)

def add_rates(df):
    df = df.sort_values("Date")
    g = df.groupby(["geo", "coicop"], sort=False)
    df["Prev"]   = g["value"].shift(1)
    df["Prev12"] = g["value"].shift(12)
    df["MoM"]    = (df["value"] - df["Prev"]) / df["Prev"]
    df["YoY"]    = (df["value"] - df["Prev12"]) / df["Prev12"]
    return df</code></pre>
            <p class="text-slate-600 text-sm mt-2">
              The rate formulas mirror DAX measures (MoM/YoY) so the Python app matches Power&nbsp;BI outputs.
            </p>
          </div>

          <div class="bg-white rounded-xl p-5 shadow border border-slate-200 mb-8">
            <div class="flex items-center justify-between mb-3">
              <p class="font-semibold text-slate-800 m-0">tabs.py — Plotly visuals (example)</p>
              <a class="text-blue-600 text-sm hover:underline" target="_blank" rel="noopener"
                 href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/tabs.py">Open file</a>
            </div>
<pre class="language-python"><code>import plotly.express as px

def annual_rate_by_country(df, coicop="CP00"):
    d = df[df["coicop"] == coicop]
    fig = px.line(
        d, x="Date", y="YoY", color="geo",
        title="Annual inflation rate (YoY %) — by date and country",
        labels={"YoY": "YoY (%)"}, markers=False
    )
    fig.update_yaxes(tickformat=".1%")
    fig.update_layout(template="plotly_dark", legend_title_text="")
    return fig</code></pre>
          </div>

          <div class="bg-white rounded-xl p-5 shadow border border-slate-200">
            <div class="flex items-center justify-between mb-3">
              <p class="font-semibold text-slate-800 m-0">main.py — wiring</p>
              <a class="text-blue-600 text-sm hover:underline" target="_blank" rel="noopener"
                 href="https://github.com/sabers13/Eurostat-HICP/blob/main/app/main.py">Open file</a>
            </div>
<pre class="language-python"><code># Pseudocode wiring (framework-agnostic)
from helpers import build_url, tidy_from_jsonstat, add_rates
from tabs import annual_rate_by_country
from filters import GEOS, COICOPS, DEFAULT_START, DEFAULT_END
import requests

url = build_url(DEFAULT_START, DEFAULT_END, GEOS, COICOPS)
js = requests.get(url, headers={"Accept":"application/json"}, timeout=60).json()
df = add_rates(tidy_from_jsonstat(js))

fig = annual_rate_by_country(df)
# render(fig)  # Streamlit, Dash, or your chosen UI toolkit</code></pre>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="py-8">
      <div class="max-w-6xl mx-auto px-6">
        <div class="flex flex-wrap gap-3">
          <a href="../index.html#contact"
             class="inline-flex items-center px-5 py-2.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
            <i data-feather="briefcase" class="w-5 h-5 mr-2"></i> Hire Me
          </a>
          <a href="https://github.com/sabers13/Eurostat-HICP/tree/main"            
            target="_blank" rel="noopener" class="btnx btnx-dark">
          <i data-feather="github" class="w-5 h-5"></i> Repository
        </a>
          </a>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-gray-900 text-gray-300 py-10 mt-8">
    <div class="max-w-6xl mx-auto px-6 text-center">
      <p>&copy; 2025 Saber Sojudi. All rights reserved.</p>
    </div>
  </footer>

  <!-- Lightbox (global for ALL images) -->
  <div id="lightbox" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[80] hidden">
    <button class="absolute top-4 right-4 bg-white/95 hover:bg-white text-slate-900 rounded-full p-2 shadow" data-close aria-label="Close">
      <i data-feather="x" class="w-5 h-5"></i>
    </button>
    <div class="w-full h-full flex items-center justify-center p-4">
      <img id="lightboxImg" src="" alt="" class="max-w-7xl max-h-[90vh] w-auto h-auto object-contain rounded-lg shadow-lg bg-white">
    </div>
  </div>

  <script>
    AOS.init({ duration: 800, once: true });
    feather.replace();

    // Mobile menu toggle
    const btn = document.getElementById('menuBtn');
    const menu = document.getElementById('mobileMenu');
    if (btn && menu) btn.addEventListener('click', () => menu.classList.toggle('hidden'));

    // Smooth scroll with offset for fixed header
    function smoothTo(id){
      const el = document.querySelector(id);
      if(!el) return;
      const y = el.getBoundingClientRect().top + window.scrollY - 90;
      window.scrollTo({ top: y, behavior: 'smooth' });
    }
    document.querySelectorAll('a[href^="#"]').forEach(a=>{
      a.addEventListener('click', e=>{
        const href = a.getAttribute('href');
        if (!href || href === '#') return;
        e.preventDefault();
        smoothTo(href);
        if (menu && !menu.classList.contains('hidden')) menu.classList.add('hidden');
      });
    });

    // Active link underline while scrolling
    const ids  = ['#overview','#model','#measures','#powerquery','#pyapp'];
    const secs = ids.map(i=>document.querySelector(i)).filter(Boolean);
    const links = Array.from(document.querySelectorAll('.nav-link')).filter(l=>ids.includes(l.getAttribute('href')));
    function setActive(){
      let current = secs[0];
      for (const s of secs){ if (s.getBoundingClientRect().top - 110 <= 0) current = s; }
      links.forEach(l=> l.classList.toggle('active', l.getAttribute('href') === '#'+current.id));
    }
    document.addEventListener('scroll', setActive, { passive:true });
    window.addEventListener('load', setActive);

    // Collapsible long code blocks
    const MAX = 320; // px
    document.querySelectorAll('pre.code, pre[class*="language-"]').forEach(pre=>{
      const wrap = pre.closest('.code-wrap') || pre.parentElement;
      wrap.classList.add('code-wrap');
      requestAnimationFrame(()=>{
        if (pre.scrollHeight > MAX) {
          pre.classList.add('clamp');
          const overlay = document.createElement('div');
          overlay.className = 'code-overlay';
          wrap.appendChild(overlay);
          const btn = document.createElement('button');
          btn.className = 'expand-btn';
          btn.textContent = 'Expand';
          btn.addEventListener('click', ()=>{
            const expanded = !pre.classList.contains('clamp');
            pre.classList.toggle('clamp');
            overlay.style.display = expanded ? 'block' : 'none';
            btn.textContent = expanded ? 'Expand' : 'Collapse';
          });
          wrap.appendChild(btn);
        }
      });
    });

    // Slider + autoplay + dots + swipe
    (function(){
      const root  = document.querySelector('[data-slider]');
      if(!root) return;

      const track   = root.querySelector('[data-track]');
      const slides  = Array.from(track.children);
      const prevBtn = root.querySelector('[data-prev]');
      const nextBtn = root.querySelector('[data-next]');
      const dots    = Array.from(root.querySelectorAll('[data-dot]'));
      const counter = root.querySelector('[data-counter]');
      const progress= root.querySelector('[data-progress]');

      const N = slides.length;
      let idx = 0, timer = null, progTimer = null, paused = false;
      const AUTOPLAY_MS = 4500;

      function setActive(i){
        idx = (i+N)%N;
        track.style.transform = `translateX(-${idx*100}%)`;
        dots.forEach((d,k)=> d.style.backgroundColor = (k===idx? '#2563eb' : '#cbd5e1'));
        if (counter) counter.textContent = `${idx+1} / ${N}`;
        if (progress) progress.style.width = '0%';
      }
      function next(){ setActive(idx+1); restartAutoplay(); }
      function prev(){ setActive(idx-1); restartAutoplay(); }

      function restartAutoplay(){
        clearInterval(timer); clearInterval(progTimer);
        let t = 0, step = 50;
        progTimer = setInterval(()=>{
          if (paused) return;
          t += step;
          const pct = Math.min(100, (t/AUTOPLAY_MS)*100);
          progress && (progress.style.width = pct+'%');
        }, step);
        timer = setInterval(()=>{ if(!paused){ next(); } }, AUTOPLAY_MS);
      }

      root.addEventListener('mouseenter', ()=> paused=true);
      root.addEventListener('mouseleave', ()=> paused=false);

      dots.forEach(d=> d.addEventListener('click', ()=> { setActive(parseInt(d.dataset.dot)); restartAutoplay(); }));
      prevBtn.addEventListener('click', prev);
      nextBtn.addEventListener('click', next);

      // Swipe
      let startX=null;
      track.addEventListener('touchstart', (e)=>{ startX = e.touches[0].clientX; }, {passive:true});
      track.addEventListener('touchend', (e)=>{
        if(startX===null) return;
        const dx = e.changedTouches[0].clientX - startX;
        if (Math.abs(dx) > 40) (dx<0 ? next() : prev());
        startX=null;
      }, {passive:true});

      setActive(0);
      restartAutoplay();
    })();

    // GLOBAL LIGHTBOX — click ANY <img> to enlarge
    (function(){
      const lb = document.getElementById('lightbox');
      const img = document.getElementById('lightboxImg');
      const close = lb.querySelector('[data-close]');

      document.addEventListener('click', (e)=>{
        const pic = e.target.closest('img');
        if(!pic || pic.closest('#lightbox')) return;
        const src = pic.getAttribute('data-zoom') || pic.getAttribute('src');
        if(!src) return;
        img.src = src;
        lb.classList.remove('hidden');
      });

      close.addEventListener('click', ()=> lb.classList.add('hidden'));
      lb.addEventListener('click', (e)=> { if(e.target===lb) lb.classList.add('hidden'); });
      document.addEventListener('keydown', (e)=> { if(e.key==='Escape') lb.classList.add('hidden'); });
    })();
  </script>
</body>
</html>
